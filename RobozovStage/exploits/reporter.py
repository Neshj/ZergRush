#!/usr/bin/python
from socket import *
from struct import *
from select import *

REPORTER_IP = "localhost"
REPORTER_PORT = 1313

def reporter_init():
	s = socket(AF_INET, SOCK_DGRAM)
	s.bind((REPORTER_IP, REPORTER_PORT))

	return s

def reporter_wait(s, wait_time = 3):
	r, w, x = select([s], [], [], wait_time)

	if len(r) != 1:
		return "", ""
	else:
		return reporter_recv(s)

def reporter_recv(s):
	pkt, addr = s.recvfrom(1024)

	# Recv the size of string
	size = unpack("I", pkt[:4])[0]
	
	# Recv the string
	return pkt[4:size + 4], addr
